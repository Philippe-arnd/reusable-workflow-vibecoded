name: Auto Merge

on:
  workflow_run:
    workflows:
      - 'PR Validation'
      - 'Security & Performance'
      - 'Dependency Review'
      - 'Docker Validation'
    types: [completed]

jobs:
  auto-merge:
    uses: Philippe-arnd/reusable-workflow-vibecoded/.github/workflows/reusable-auto-merge.yml@main
    secrets: inherit
    with:
      base-branch: main
      merge-method: squash
      block-label: major-update
      required-checks: |
        âœ… Quick Checks
        ğŸ§ª Vitest Tests
        ğŸ”’ RLS Tests
        ğŸ”‘ Secret Detection
        ğŸ›¡ï¸ Security Scan
        ğŸ” Review Dependencies for Vulnerabilities
      conditional-checks: |
        ğŸ³ Build & Validate Docker Image
